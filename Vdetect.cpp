#include "Vdetect.hpp"
#include "Reg.hpp"

enum {
    HLVDCON = 0xBF802920,
        ON = 1<<15,
        SIDL = 1<<13,
        VDIR = 1<<11,
        BGVST = 1<<10,
        IRVST = 1<<9,
        HLEVT = 1<<8
};

//=============================================================================
    void        Vdetect::on             (bool tf)
//=============================================================================
{
    Reg::setbit(HLVDCON, ON, tf);
}

//=============================================================================
    void        Vdetect::stop_idle      (bool tf)
//=============================================================================
{
    Reg::setbit(HLVDCON, SIDL, tf);
}

//=============================================================================
    void        Vdetect::trip_above     (bool tf)
//=============================================================================
{
    Reg::setbit(HLVDCON, VDIR, tf);
}

//=============================================================================
    bool        Vdetect::bgap_stable    ()
//=============================================================================
{
    return Reg::anybit(HLVDCON, BGVST);
}

//=============================================================================
    bool        Vdetect::iref_stable    ()
//=============================================================================
{
    return Reg::anybit(HLVDCON, IRVST);
}

//=============================================================================
    bool        Vdetect::tripped        ()
//=============================================================================
{
    return Reg::anybit(HLVDCON, HLEVT);
}

//=============================================================================
    void        Vdetect::limit          (HLVDL e)
//=============================================================================
{
    Reg::clrbit(HLVDCON, VEXT);
    Reg::setbit(HLVDCON, e);
}

